<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Command Center</title>
<link rel="icon" type="image/png" href="/static/soren_profile.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/static/dashboard.css?v=20260225b">
</head>
<body>
<nav class="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-brand-text">Command Center</div>
    <div class="sidebar-online"><span class="dot-online"></span><span id="sidebar-agents-online">15</span> Agents Online</div>
  </div>

  <div class="sidebar-scroll">
    <div class="sidebar-section-label">OVERVIEW</div>
    <button class="sidebar-btn active" data-tab="overview" style="--accent:var(--text-secondary);" onclick="switchTab('overview')">Dashboard</button>

    <div class="sidebar-section-label sidebar-section-traders">TRADERS</div>
    <button class="sidebar-btn sidebar-btn-traders" data-tab="traders" style="--accent:#10B981;" onclick="switchTab('traders')">Traders</button>

    <div class="sidebar-section-label">EDGE</div>
    <button class="sidebar-btn" data-tab="pnl" style="--accent:#10B981;" onclick="switchTab('pnl')">P&L Overview</button>

    <div class="sidebar-section-label">TRADING AGENTS</div>
    <button class="sidebar-btn" data-tab="garves-live" style="--accent:var(--agent-garves);" onclick="switchTab('garves-live')">Garves</button>
    <button class="sidebar-btn" data-tab="odin" style="--accent:var(--agent-odin);" onclick="switchTab('odin')">Odin</button>
    <button class="sidebar-btn" data-tab="hawk" style="--accent:var(--agent-hawk);" onclick="switchTab('hawk')">Hawk</button>
    <button class="sidebar-btn" data-tab="oracle" style="--accent:var(--agent-oracle);" onclick="switchTab('oracle')">Oracle</button>
    <button class="sidebar-btn" data-tab="quant" style="--accent:var(--agent-quant);" onclick="switchTab('quant')">Quant</button>

    <div class="sidebar-section-label">INTELLIGENCE</div>
    <button class="sidebar-btn" data-tab="atlas" style="--accent:var(--agent-atlas);" onclick="switchTab('atlas')">Atlas</button>
    <button class="sidebar-btn" data-tab="soren" style="--accent:var(--agent-soren);" onclick="switchTab('soren')">Soren</button>
    <button class="sidebar-btn" data-tab="lisa" style="--accent:var(--agent-lisa);" onclick="switchTab('lisa')">Lisa</button>

    <div class="sidebar-section-label">OPERATIONS</div>
    <button class="sidebar-btn" data-tab="shelby" style="--accent:var(--agent-shelby);" onclick="switchTab('shelby')">Shelby</button>
    <button class="sidebar-btn" data-tab="sentinel" style="--accent:var(--agent-sentinel);" onclick="switchTab('sentinel')">Robotox</button>
    <button class="sidebar-btn" data-tab="thor" style="--accent:var(--agent-thor);" onclick="switchTab('thor')">Thor</button>
    <button class="sidebar-btn" data-tab="viper" style="--accent:var(--agent-viper);" onclick="switchTab('viper')">Viper</button>

    <div class="sidebar-section-label">INFRASTRUCTURE</div>
    <button class="sidebar-btn" data-tab="intelligence" style="--accent:#9B59B6;" onclick="switchTab('intelligence')">Intelligence</button>
    <button class="sidebar-btn" data-tab="system" style="--accent:#aaaaaa;" onclick="switchTab('system')">Monitoring</button>
  </div>

  <div class="sidebar-footer">
    <input type="text" class="sidebar-search" id="sidebar-search" placeholder="Search..." autocomplete="off" oninput="sidebarSearch(this.value)">
    <div class="sidebar-global-status" id="sidebar-global-status">
      <span class="sidebar-status-dot"></span>All Systems Nominal
    </div>
  </div>
</nav>

<main class="main">
  <header class="header">
    <div class="header-left">
      <h1 class="header-title">Command Center</h1>
      <div class="header-subtitle"><span class="dot-online"></span> <span id="agents-online-count">15</span> Agents Online</div>
    </div>
    <div class="header-right">Last update: <span id="last-update">--:--:--</span></div>
  </header>

  {% include 'tabs/pnl.html' %}
  {% include 'tabs/traders.html' %}
  {% include 'tabs/overview.html' %}
  {% include 'tabs/garves_live.html' %}
  {% include 'tabs/soren.html' %}
  {% include 'tabs/shelby.html' %}
  {% include 'tabs/atlas.html' %}
  {% include 'tabs/lisa.html' %}
  {% include 'tabs/robotox.html' %}
  {% include 'tabs/thor.html' %}
  {% include 'tabs/hawk.html' %}
  {% include 'tabs/viper.html' %}
  {% include 'tabs/quant.html' %}
  {% include 'tabs/odin.html' %}
  {% include 'tabs/oracle.html' %}
  {% include 'tabs/discord.html' %}
  {% include 'tabs/system.html' %}
  {% include 'tabs/intelligence.html' %}
  <!-- Video Modal -->
  <div class="video-modal" id="video-modal">
    <div class="video-modal-inner">
      <video id="modal-video" controls></video>
      <div class="video-modal-btns">
        <button class="btn" id="modal-download-btn">Download</button>
        <button class="btn btn-error" onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>

  <!-- KPI Modal -->
  <div class="generic-modal" id="kpi-modal">
    <div class="generic-modal-inner" style="position:relative;">
      <div class="modal-title" id="kpi-modal-title">Performance KPIs</div>
      <div id="kpi-modal-content"><div class="text-muted">Loading...</div></div>
      <div style="margin-top:var(--space-6);text-align:right;">
        <button class="btn btn-error" onclick="closeKPIModal()">Close</button>
      </div>
    </div>
  </div>

</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="/static/js/components.js?v=20260220b"></script>
<script src="/static/js/charts.js?v=20260220b"></script>
<script src="/static/dashboard.js?v=20260225b"></script>
<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
<script>
// SocketIO real-time connection (optional â€” degrades gracefully)
(function() {
  if (typeof io === 'undefined') return;
  try {
    var socket = io({transports: ['websocket', 'polling']});
    socket.on('connect', function() {
      console.log('[SocketIO] Connected to Command Center');
      var dot = document.querySelector('.dot-online');
      if (dot) dot.style.background = 'var(--success)';
    });
    socket.on('disconnect', function() {
      console.log('[SocketIO] Disconnected');
    });
    socket.on('heartbeats', function(data) {
      console.log('[SocketIO] Heartbeat push received');
    });
    // Real-time trade alerts
    socket.on('trade_new', function(data) {
      var asset = (data.asset || '?').toUpperCase();
      var dir = (data.direction || '?').toUpperCase();
      var edge = ((data.edge || 0) * 100).toFixed(1);
      var tf = data.timeframe || '';
      showToast('Garves: ' + asset + '/' + tf + ' ' + dir + ' (' + edge + '% edge)', 'trade');
    });
    socket.on('trade_resolved', function(data) {
      var asset = (data.asset || '?').toUpperCase();
      var dir = (data.direction || '?').toUpperCase();
      var pnl = (data.pnl || 0).toFixed(2);
      if (data.won) {
        showToast('WIN: ' + asset + ' ' + dir + ' +$' + pnl, 'success');
      } else {
        showToast('LOSS: ' + asset + ' ' + dir + ' -$' + Math.abs(data.pnl || 0).toFixed(2), 'error');
      }
    });
    socket.on('agent_status', function(data) {
      showToast((data.agent || 'Agent') + ': ' + (data.message || 'status update'), 'info');
    });
    window._ccSocket = socket;
  } catch(e) {
    console.log('[SocketIO] Not available, using polling');
  }
})();
// Cmd/Ctrl+K focuses sidebar search
document.addEventListener('keydown', function(e) {
  if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
    e.preventDefault();
    var s = document.getElementById('sidebar-search');
    if (s) s.focus();
  }
});
</script>
</body>
</html>
