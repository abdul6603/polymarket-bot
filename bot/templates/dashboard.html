<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Command Center</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/static/dashboard.css">
</head>
<body>
<nav class="sidebar">
  <div class="sidebar-brand">CC</div>
  <button class="sidebar-btn active" data-tab="overview" onclick="switchTab('overview')" title="Overview">Overview</button>
  <button class="sidebar-btn" data-tab="garves-live" onclick="switchTab('garves-live')" title="Garves Live" style="color:#00ff88;">Garves $</button>
  <button class="sidebar-btn" data-tab="garves" onclick="switchTab('garves')" title="Garves Sim">Garves Sim</button>
  <button class="sidebar-btn" data-tab="soren" onclick="switchTab('soren')" title="Soren">Soren</button>
  <button class="sidebar-btn" data-tab="shelby" onclick="switchTab('shelby')" title="Shelby">Shelby</button>
  <button class="sidebar-btn" data-tab="atlas" onclick="switchTab('atlas')" title="Atlas">Atlas</button>
  <button class="sidebar-btn" data-tab="mercury" onclick="switchTab('mercury')" title="Lisa">Lisa</button>
  <button class="sidebar-btn" data-tab="sentinel" onclick="switchTab('sentinel')" title="Robotox">Robotox</button>
  <button class="sidebar-btn" data-tab="thor" onclick="switchTab('thor')" title="Thor">Thor</button>
  <button class="sidebar-btn" data-tab="hawk" onclick="switchTab('hawk')" title="Hawk" style="color:#FFD700;">Hawk</button>
  <button class="sidebar-btn" data-tab="viper" onclick="switchTab('viper')" title="Viper" style="color:#00ff88;">Viper</button>
  <div class="sidebar-spacer"></div>
  <button class="sidebar-btn" data-tab="system" onclick="switchTab('system')" title="System">System</button>
  <button class="sidebar-btn" data-tab="chat" onclick="switchTab('chat')" title="Chat">Chat</button>
</nav>

<main class="main">
  <header class="header">
    <div class="header-left">
      <h1 class="header-title">Command Center</h1>
      <div class="header-subtitle"><span class="dot-online"></span> 9 Agents Online</div>
    </div>
    <div class="header-right">Last update: <span id="last-update">--:--:--</span></div>
  </header>

  {% include 'tabs/overview.html' %}
  {% include 'tabs/garves_live.html' %}
  {% include 'tabs/garves_sim.html' %}
  {% include 'tabs/soren.html' %}
  {% include 'tabs/shelby.html' %}
  {% include 'tabs/atlas.html' %}
  {% include 'tabs/lisa.html' %}
  {% include 'tabs/robotox.html' %}
  {% include 'tabs/thor.html' %}
  {% include 'tabs/hawk.html' %}
  {% include 'tabs/viper.html' %}
  {% include 'tabs/system.html' %}
  {% include 'tabs/chat.html' %}

  <!-- Agent Chat Popup -->
  <div id="agent-chat-popup" class="agent-chat-popup" style="display:none;">
    <div class="agent-chat-header">
      <span id="agent-chat-title">Chat with Agent</span>
      <button onclick="closeAgentChat()" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:1.1rem;">&times;</button>
    </div>
    <div id="agent-chat-messages" class="agent-chat-messages"></div>
    <div class="agent-chat-input-row">
      <input type="text" class="input" id="agent-chat-input" placeholder="Type a message..." onkeydown="if(event.key==='Enter')sendAgentChat()" style="flex:1;font-size:0.76rem;padding:6px 10px;">
      <button class="btn btn-primary" onclick="sendAgentChat()" id="agent-chat-send" style="padding:6px 14px;font-size:0.74rem;">Send</button>
    </div>
  </div>

  <!-- Video Modal -->
  <div class="video-modal" id="video-modal">
    <div class="video-modal-inner">
      <video id="modal-video" controls></video>
      <div class="video-modal-btns">
        <button class="btn" id="modal-download-btn">Download</button>
        <button class="btn btn-error" onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>

  <!-- KPI Modal -->
  <div class="generic-modal" id="kpi-modal">
    <div class="generic-modal-inner" style="position:relative;">
      <div class="modal-title" id="kpi-modal-title">Performance KPIs</div>
      <div id="kpi-modal-content"><div class="text-muted">Loading...</div></div>
      <div style="margin-top:var(--space-6);text-align:right;">
        <button class="btn btn-error" onclick="closeKPIModal()">Close</button>
      </div>
    </div>
  </div>

</main>

<script src="/static/dashboard.js"></script>
<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
<script>
// SocketIO real-time connection (optional â€” degrades gracefully)
(function() {
  if (typeof io === 'undefined') return;
  try {
    var socket = io({transports: ['websocket', 'polling']});
    socket.on('connect', function() {
      console.log('[SocketIO] Connected to Command Center');
      var dot = document.querySelector('.dot-online');
      if (dot) dot.style.background = 'var(--success)';
    });
    socket.on('disconnect', function() {
      console.log('[SocketIO] Disconnected');
    });
    socket.on('heartbeats', function(data) {
      console.log('[SocketIO] Heartbeat push received');
    });
    window._ccSocket = socket;
  } catch(e) {
    console.log('[SocketIO] Not available, using polling');
  }
})();
</script>
</body>
</html>
