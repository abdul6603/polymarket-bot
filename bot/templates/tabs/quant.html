<div id="tab-quant" class="tab-content">
  <div id="intel-quant" class="intel-meter" style="margin-bottom:12px;"></div>
  <!-- Agent Badge Row -->
  <div class="d-flex align-center gap-3 mb-4">
    <div class="agent-card-initial" style="background:#00BFFF22;color:#00BFFF;font-size:1.1rem;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:10px;">QT</div>
    <div>
      <div style="font-weight:600;color:var(--text-primary);">Quant — The Strategy Alchemist</div>
      <div class="text-muted" style="font-size:0.72rem;">Strategy Lab | Mode: <span id="quant-mode">Historical Replay</span> | Cycle: <span id="quant-cycle">--</span> | Optimizer: <span id="quant-optimizer" style="color:#00BFFF;">--</span></div>
    </div>
    <div style="margin-left:auto;display:flex;gap:8px;">
      <button class="btn btn-primary" onclick="quantTriggerRun()" id="quant-run-btn" style="font-size:0.72rem;padding:6px 14px;">Trigger Backtest</button>
      <button class="btn" onclick="quantHealthCheck()" style="font-size:0.72rem;padding:6px 14px;">Health Check</button>
      <button class="agent-chat-trigger" onclick="openAgentChat('quant')" style="font-size:0.72rem;color:#00BFFF;">Chat</button>
    </div>
  </div>

  <!-- Progress bar (hidden by default) -->
  <div id="quant-progress-bar" style="display:none;margin-bottom:16px;">
    <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
      <span class="text-muted" style="font-size:0.7rem;" id="quant-progress-label">Running...</span>
      <span class="text-muted" style="font-size:0.7rem;" id="quant-progress-pct">0%</span>
    </div>
    <div style="background:var(--card-bg);border-radius:4px;height:6px;overflow:hidden;">
      <div id="quant-progress-fill" style="background:#00BFFF;height:100%;width:0%;transition:width 0.3s;border-radius:4px;"></div>
    </div>
    <div class="text-muted" style="font-size:0.65rem;margin-top:2px;" id="quant-progress-detail"></div>
  </div>

  <!-- Smart Actions -->
  <div class="section-spacer" style="margin-top:0;margin-bottom:16px;">
    <h2 class="section-title" style="color:#00BFFF;">Suggested Actions</h2>
    <div id="quant-smart-actions" style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px;"><span class="text-muted" style="font-size:0.76rem;">Loading...</span></div>
  </div>

  <!-- Stat Cards Row 1: Core metrics -->
  <div class="stat-grid" style="grid-template-columns:repeat(6,1fr);margin-bottom:12px;">
    <div class="stat-card">
      <div class="stat-label">Combos Tested</div>
      <div class="stat-value" id="quant-total-combos" style="color:#00BFFF;">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Parameter combinations evaluated</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Best WR Found</div>
      <div class="stat-value" id="quant-best-wr" style="color:var(--success);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Highest win rate from backtests</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Current Live WR</div>
      <div class="stat-value" id="quant-baseline-wr" style="color:var(--warning);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Garves's current live win rate</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">95% Confidence</div>
      <div class="stat-value" id="quant-ci" style="color:#00BFFF;font-size:0.85rem;">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Statistical confidence range</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Out-of-Sample WR</div>
      <div class="stat-value" id="quant-wf-oos" style="color:var(--warning);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Walk-forward test accuracy</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Overfit Drop</div>
      <div class="stat-value" id="quant-overfit">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Gap between train &amp; test WR</div>
    </div>
  </div>

  <!-- Stat Cards Row 2: Analytics -->
  <div class="stat-grid" style="grid-template-columns:repeat(6,1fr);margin-bottom:20px;">
    <div class="stat-card">
      <div class="stat-label">Trades Loaded</div>
      <div class="stat-value" id="quant-trades" style="color:var(--text-muted);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Historical trades for replay</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Avg Edge</div>
      <div class="stat-value" id="quant-avg-edge" style="color:var(--success);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Mean price advantage per trade</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Kelly (Half)</div>
      <div class="stat-value" id="quant-kelly" style="color:#00BFFF;">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Optimal position size %</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Diversity Score</div>
      <div class="stat-value" id="quant-diversity" style="color:var(--success);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Indicator independence</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Strategy Health</div>
      <div class="stat-value" id="quant-decay-status" style="font-size:0.85rem;">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Is strategy still working?</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Filter Losses</div>
      <div class="stat-value" id="quant-filtered" style="color:var(--text-muted);">--</div>
      <div class="text-muted" style="font-size:0.6rem;">Trades rejected by filters</div>
    </div>
  </div>

  <!-- Row: Walk-Forward + Kelly -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
    <!-- Walk-Forward Results -->
    <div class="card">
      <div class="card-header">Walk-Forward Validation <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">Tests strategy on unseen data to check for overfitting</span></div>
      <table class="table">
        <thead><tr><th>Fold</th><th>Train Size</th><th>Train WR</th><th>Test Size</th><th>Test WR</th></tr></thead>
        <tbody id="quant-wf-tbody">
          <tr><td colspan="5" class="text-muted" style="text-align:center;padding:20px;">Run a backtest to see walk-forward results</td></tr>
        </tbody>
      </table>
    </div>

    <!-- Kelly + Decay -->
    <div class="card">
      <div class="card-header">Position Sizing &amp; Strategy Health <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">How much to bet and is the strategy still working?</span></div>
      <div id="quant-analytics-detail" style="padding:12px;">
        <div class="text-muted" style="text-align:center;padding:20px;">No analytics data yet</div>
      </div>
    </div>
  </div>

  <!-- Row: Current vs Best + Recommendations -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
    <!-- Current vs Best Strategy -->
    <div class="card">
      <div class="card-header">Current vs Best Strategy <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">Live params vs what backtest found optimal</span></div>
      <table class="table">
        <thead><tr><th>Parameter</th><th>Current</th><th>Best</th><th>Delta</th></tr></thead>
        <tbody id="quant-params-tbody">
          <tr><td colspan="4" class="text-muted" style="text-align:center;padding:20px;">Run a backtest to see comparison</td></tr>
        </tbody>
      </table>
    </div>

    <!-- Recommendations -->
    <div class="card">
      <div class="card-header">Recommendations</div>
      <div id="quant-recommendations" style="padding:12px;">
        <div class="text-muted" style="text-align:center;padding:20px;">No recommendations yet</div>
      </div>
    </div>
  </div>

  <!-- Indicator Diversity -->
  <div class="card" style="margin-bottom:20px;">
    <div class="card-header">Indicator Diversity Analysis <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">Are indicators independent or just saying the same thing?</span></div>
    <div id="quant-diversity-detail" style="padding:12px;">
      <div class="text-muted" style="text-align:center;padding:20px;">No diversity data yet</div>
    </div>
  </div>

  <!-- Parameter Sensitivity -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
    <div class="card">
      <div class="card-header">Consensus Sensitivity <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">How WR changes at different agreement thresholds</span></div>
      <table class="table">
        <thead><tr><th>Min Consensus</th><th>Avg WR</th><th>Avg Signals</th><th>Combos</th></tr></thead>
        <tbody id="quant-consensus-tbody">
          <tr><td colspan="4" class="text-muted" style="text-align:center;">--</td></tr>
        </tbody>
      </table>
    </div>
    <div class="card">
      <div class="card-header">Edge Sensitivity <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">How WR changes at different minimum edge levels</span></div>
      <table class="table">
        <thead><tr><th>Min Edge</th><th>Avg WR</th><th>Avg Signals</th><th>Combos</th></tr></thead>
        <tbody id="quant-edge-tbody">
          <tr><td colspan="4" class="text-muted" style="text-align:center;">--</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Top Backtest Results -->
  <div class="card" style="margin-bottom:20px;">
    <div class="card-header">Top Backtest Results <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">Best parameter combinations ranked by score</span></div>
    <table class="table">
      <thead><tr><th>#</th><th>Label</th><th>Score</th><th>Win Rate</th><th>PF</th><th>Signals</th><th>W/L</th><th>Avg Edge</th></tr></thead>
      <tbody id="quant-results-tbody">
        <tr><td colspan="8" class="text-muted" style="text-align:center;padding:20px;">No results yet — trigger a backtest</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Hawk Trade Review -->
  <div class="card" style="margin-bottom:20px;">
    <div class="card-header">Hawk Trade Review <span class="text-muted" style="font-size:0.65rem;font-weight:400;margin-left:6px;">Quant's analysis of Hawk's trading patterns</span></div>
    <div id="quant-hawk-review" style="padding:12px;">
      <div class="text-muted" style="text-align:center;padding:20px;">No Hawk data available</div>
    </div>
  </div>


  <!-- Last updated -->
  <div class="text-muted" style="font-size:0.65rem;margin-top:12px;text-align:right;">
    Last update: <span id="quant-last-update">--</span>
  </div>
</div>
