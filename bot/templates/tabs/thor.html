<!-- THOR -->
<div class="tab-content" id="tab-thor">
  <div id="intel-thor" class="intel-meter" style="margin-bottom:12px;"></div>
  <div class="agent-widget-row" id="thor-widgets">
    <div class="widget-badge" id="thor-state"><span class="wb-label">State:</span> <span>--</span></div>
    <div class="widget-badge" id="thor-model"><span class="wb-label">Model:</span> <span>--</span></div>
    <button class="btn" onclick="healthCheckAgent('thor')" style="font-size:0.72rem;">Health Check</button>
</div>

  <!-- Wake Control Panel -->
  <div class="glass-card" style="margin:12px 0;border-left:3px solid #ff6600;padding:12px 16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;">
      <div>
        <h3 style="font-size:0.82rem;margin:0 0 4px;color:#ff6600;font-weight:700;">Wake Control</h3>
        <span class="text-muted" style="font-size:0.7rem;">Thor sleeps and wakes every 12h to review issues. Budget: $2/day max.</span>
      </div>
      <div style="display:flex;gap:8px;align-items:center;">
        <button class="btn" id="btn-thor-wake" onclick="thorWakeNow()" style="font-size:0.78rem;background:#ff6600;color:#000;font-weight:700;padding:6px 16px;">Wake Now</button>
        <span id="thor-wake-status" style="font-size:0.72rem;color:var(--text-muted);"></span>
      </div>
    </div>
    <div style="display:flex;gap:16px;align-items:center;margin-top:8px;flex-wrap:wrap;">
      <label style="font-size:0.74rem;display:flex;align-items:center;gap:6px;cursor:pointer;">
        <input type="checkbox" id="thor-auto-wake" onchange="thorToggleAutoWake()" checked />
        <span>Auto-wake every</span>
      </label>
      <select id="thor-wake-interval" onchange="thorUpdateInterval()" style="font-size:0.74rem;padding:2px 6px;background:var(--bg-card);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px;">
        <option value="6">6h</option>
        <option value="12" selected>12h</option>
        <option value="24">24h</option>
      </select>
      <span id="thor-next-wake" class="text-muted" style="font-size:0.72rem;"></span>
      <span id="thor-last-wake" class="text-muted" style="font-size:0.72rem;"></span>
    </div>
  </div>
  <div class="health-inline" id="thor-health-result"></div>
  <div class="grid-6">
    <div class="stat-card" data-accent="thor"><div class="stat-value" id="thor-queue-pending">0</div><div class="stat-label">Pending Tasks</div></div>
    <div class="stat-card" data-accent="success"><div class="stat-value" id="thor-completed">0</div><div class="stat-label">Completed</div></div>
    <div class="stat-card" data-accent="warning"><div class="stat-value" id="thor-failed">0</div><div class="stat-label">Failed</div></div>
    <div class="stat-card" data-accent="thor"><div class="stat-value" id="thor-knowledge">0</div><div class="stat-label">Knowledge Entries</div></div>
    <div class="stat-card" data-accent="thor"><div class="stat-value" id="thor-tokens">0</div><div class="stat-label">Tokens Used</div></div>
    <div class="stat-card" data-accent="success"><div class="stat-value" id="thor-success-rate">--</div><div class="stat-label">Success Rate</div></div>
  </div>

  <!-- Action Buttons -->
  <div style="display:flex;gap:8px;margin:12px 0;flex-wrap:wrap;">
    <button class="btn" id="btn-update-sheet" onclick="thorUpdateSheet()" style="font-size:0.76rem;background:#ff6600;color:#000;font-weight:600;">Update Progress Sheet</button>
    <button class="btn" id="btn-update-brotherhood" onclick="thorUpdateBrotherhood()" style="font-size:0.76rem;background:#ff6600;color:#000;font-weight:600;">Update Brotherhood Sheet</button>
    <button class="btn" id="btn-update-dash" onclick="thorUpdateDashboard()" style="font-size:0.76rem;background:#ff6600;color:#000;font-weight:600;">Update Dashboard</button>
    <span id="thor-action-status" class="text-muted" style="font-size:0.72rem;align-self:center;"></span>
  </div>

  <!-- Smart Actions — ABOVE activity -->
  <div class="section-spacer" style="margin-top:0;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-3);">
      <h2 class="section-title" data-accent="thor" style="margin-bottom:0;">Smart Actions</h2>
      <button class="btn" onclick="loadSmartActions()" style="font-size:0.72rem;">Refresh</button>
    </div>
    <div id="thor-smart-actions" style="display:flex;flex-wrap:wrap;gap:8px;">
      <span class="text-muted">Loading live suggestions...</span>
    </div>
  </div>

  <!-- API Cost Tracker -->
  <div class="glass-card" style="margin:12px 0;border-left:3px solid var(--agent-thor);">
    <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">API Cost Tracker</h3>
    <div style="display:flex;gap:16px;align-items:center;flex-wrap:wrap;">
      <div style="font-family:var(--font-mono);font-size:0.82rem;">
        <span class="text-muted">Today:</span> <span id="thor-cost-daily" style="color:var(--success);font-weight:600;">$0.00</span>
        <span class="text-muted"> / </span><span id="thor-cost-budget">$2.00</span>
      </div>
      <div style="flex:1;min-width:120px;max-width:300px;">
        <div style="background:var(--bg-card);border-radius:4px;height:8px;overflow:hidden;">
          <div id="thor-cost-bar" style="height:100%;background:var(--success);width:0%;transition:width 0.3s;border-radius:4px;"></div>
        </div>
      </div>
      <div style="font-family:var(--font-mono);font-size:0.74rem;">
        <span class="text-muted">Total:</span> <span id="thor-cost-total">$0.00</span>
        <span class="text-muted"> | Calls:</span> <span id="thor-cost-calls">0</span>
        <span class="text-muted"> | Models:</span> <span id="thor-cost-models">--</span>
      </div>
    </div>
  </div>

  <!-- Activity Feed — merged activity + log -->
  <div class="glass-card" style="margin-bottom:12px;border-left:3px solid var(--agent-thor);">
    <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">Activity Feed</h3>
    <div id="thor-activity-feed" style="font-family:var(--font-mono);font-size:0.74rem;max-height:200px;overflow-y:auto;"><span class="text-muted">Waiting for activity...</span></div>
  </div>

  <!-- Submit Custom Task -->
  <div class="section-spacer">
    <h2 class="section-title" data-accent="thor">Submit Custom Task</h2>
    <div class="glass-card">
      <div style="display:flex;flex-direction:column;gap:var(--space-3);">
        <input type="text" class="input" id="thor-custom-title" placeholder="Task title..." style="font-family:var(--font-mono);font-size:0.78rem;" />
        <textarea class="input" id="thor-custom-desc" rows="3" placeholder="Describe what Thor should do..." style="width:100%;resize:vertical;font-family:var(--font-mono);font-size:0.78rem;"></textarea>
        <div style="display:flex;gap:var(--space-3);align-items:center;">
          <input type="text" class="input" id="thor-custom-files" placeholder="Target files (comma-separated)" style="flex:1;font-size:0.76rem;" />
          <select class="input" id="thor-custom-priority" style="font-size:0.76rem;padding:4px 8px;">
            <option value="normal">Normal</option>
            <option value="high">High</option>
            <option value="critical">Critical</option>
          </select>
          <button class="btn btn-primary" onclick="thorSubmitCustomTask()">Submit Task</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Task Queue -->
  <div class="section-spacer">
    <h2 class="section-title" data-accent="thor">Task Queue</h2>
    <div class="glass-card"><table class="data-table"><thead><tr><th>ID</th><th>Title</th><th>Agent</th><th>Priority</th><th>Status</th></tr></thead><tbody id="thor-queue-tbody"><tr><td colspan="5" class="text-muted" style="text-align:center;padding:24px;">No tasks</td></tr></tbody></table></div>
  </div>

  <!-- Recent Results -->
  <div class="section-spacer">
    <h2 class="section-title" data-accent="thor">Recent Results</h2>
    <div class="glass-card"><table class="data-table"><thead><tr><th>Task</th><th>Model</th><th>Files</th><th>Test</th><th>Phrase</th></tr></thead><tbody id="thor-results-tbody"><tr><td colspan="5" class="text-muted" style="text-align:center;padding:24px;">No results yet</td></tr></tbody></table></div>
  </div>

  <!-- Reflexion + Cache + Code Review + Progress -->
  <div class="section-spacer">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
      <div class="glass-card" style="border-left:3px solid var(--agent-thor);">
        <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">Reflexion Memory <span class="text-muted" style="font-weight:400;font-size:0.6rem;">Remembers past debugging failures</span></h3>
        <div id="thor-reflexion-stats" style="font-family:var(--font-mono);font-size:0.76rem;"><span class="text-muted">Loading...</span></div>
      </div>
      <div class="glass-card" style="border-left:3px solid var(--agent-thor);">
        <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">Response Cache <span class="text-muted" style="font-weight:400;font-size:0.6rem;">Caches similar API calls to save $</span></h3>
        <div id="thor-cache-stats" style="font-family:var(--font-mono);font-size:0.76rem;"><span class="text-muted">Loading...</span></div>
      </div>
      <div class="glass-card" style="border-left:3px solid var(--agent-thor);">
        <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">Code Review <span class="text-muted" style="font-weight:400;font-size:0.6rem;">Automated quality checks on output</span></h3>
        <div id="thor-review-stats" style="font-family:var(--font-mono);font-size:0.76rem;"><span class="text-muted">Loading...</span></div>
      </div>
      <div class="glass-card" style="border-left:3px solid var(--agent-thor);">
        <h3 class="section-title" style="font-size:0.72rem;margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);">Progress Tracker</h3>
        <div id="thor-progress-stats" style="font-family:var(--font-mono);font-size:0.76rem;"><span class="text-muted">Loading...</span></div>
      </div>
    </div>
  </div>

  <!-- Codebase Index -->
  <div class="section-spacer">
    <h2 class="section-title" data-accent="thor">Codebase Index</h2>
    <div class="glass-card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-3);">
        <span class="text-muted" style="font-size:0.76rem;">AST-parsed function/class index across all Brotherhood agents</span>
        <button class="btn" onclick="loadThorCodebaseIndex()" style="font-size:0.72rem;">Refresh</button>
      </div>
      <div id="thor-codebase-index"><div class="text-muted" style="text-align:center;padding:var(--space-4);">Loading...</div></div>
    </div>
  </div>

  <!-- Commands -->
  <div class="section-spacer">
    <h2 class="section-title" data-accent="thor">Commands &amp; Capabilities</h2>
    <div class="glass-card"><div id="thor-commands" style="max-height:250px;overflow-y:auto;"><span class="text-muted">Loading commands...</span></div></div>
  </div>
</div>
